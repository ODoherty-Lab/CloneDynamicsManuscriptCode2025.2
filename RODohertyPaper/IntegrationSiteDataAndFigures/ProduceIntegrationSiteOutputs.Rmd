---
title: "IntegrationSiteData"
author: "Sam Weissman"
date: "2025-11-23"
output: html_document
---

```{r}

base = here::here() # may need to modify depending where you open.

source(paste0(base, "/IntegrationSiteDataAndFigures/HelperFunctions/AllAtOnceFunctions.R"))
source(paste0(base, "/IntegrationSiteDataAndFigures/HelperFunctions/BinomialProportionsFunctions.R"))
source(paste0(base, "/IntegrationSiteDataAndFigures/HelperFunctions/FilteringinTableToTabulatedVersion.R"))
source(paste0(base, "/IntegrationSiteDataAndFigures/HelperFunctions/PlotProportionsAndHistogram.R"))
source(paste0(base, "/IntegrationSiteDataAndFigures/HelperFunctions/TableFormating.R"))

library(MASS)


pathToSuppData <- paste0(base, "/IntegrationSiteDataAndFigures/SuppData/")

growthTable <- data.frame(readxl::read_xlsx(paste0(pathToSuppData, "Supplementary Data 2-UsedIntegrationSitesAndGenes.xlsx"), sheet = "Integration Site Table"))
colnames(growthTable) <- growthTable[1,]
growthTable = growthTable[-1,]

for (i in 6:ncol(growthTable)) {
  growthTable[,i] <- as.numeric(growthTable[,i])
}

expressedTable <- growthTable
growthTable <- growthTable[,-5]
expressedTable <- expressedTable[,-4]




participantSets <- list(c("F07","C03","R09"),c("CT1","CT2","CT3","CT8","CT9"))

library(MASS)

doEverythingForIDSet(growthRelatedTable, paste0(pathToSuppData, "/Growth Table/"), participantSets, plotAntisense = FALSE, oneSided = 1)

doEverythingForIDSet(expressedTable, paste0(pathToSuppData, "/Expressive Table/"), participantSets, plotAntisense = FALSE, oneSided = 2)


```